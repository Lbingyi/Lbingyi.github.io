
{include file="public/header" /}
{include file="user/top" /}
{js href="__PLUG__/bootstrap-table/bootstrap-table.js" /}
{js href="__PLUG__/bootstrap-table/locale/bootstrap-table-zh-CN.js" /}
{css href="__PLUG__/bootstrap-table/bootstrap-table.css" /}
<script src="__PLUG__/layer/layer.js" type="text/javascript" charset="utf-8"></script>
<section class="container" id="jaxcontainer">
{include file="user/left" /}
	<style>
		.head-title .head-icon {
			background: #64bfff;
			display: inline-block;
			height: 18px;
			margin-right: 10px;
			vertical-align: middle;
			width: 3px;
			border-radius: 2px;
			overflow: hidden;
			vertical-align: -3px;
		}
		.table tr .th-inner {
			height: 60px;
			line-height: 60px!important;
			padding: 0!important;
			font-size: 14px!important;
			color: #191919!important;
			font-weight: 100;
		}

		.table tr {
			border-bottom: 1px solid #e5e5e5!important;
		}

		.bootstrap-table .table > thead > tr > th {
			border-bottom: 2px solid #eee!important;
			border-top: 1px solid transparent!important
		}

		.pull-left {
			display: none
		}

		.pull-right {
			float: none!important
		}
	</style>
    <div class="member-content" id="contentframe">
		<div class="head-title ovh" style="font-size:16px; line-height:54px; padding:0 20px 0;border-bottom: 2px solid #ccc;">
			<span class="head-icon" style="width:5px; height:24px; vertical-align:-6px"></span>
			订单记录
		</div>
		
		<table id="otable" class="">
		</table>	
    </div>

</section>

{include file="public/flooter" /}


<script type="text/javascript">
    var $table = $('#otable');
	window.onload = function() {
		if ($table.bootstrapTable) {
			initTable()
		} else {
			window.location.replace("{:url('home/order/index')}")
		}

		// function oper(value, row, index) {						
		// 	var id = row.id;
		// 	var status=row.trade_status;			
		// 	var opdata = '';
			
		// 	    if (status!='已付款') {
		// 	    	opdata += '<a class="btn btn-primary btn-sm" href="order/'+id+'">付款</a> <a class="btn btn-default btn-sm" href="javascript:;" onclick="del(\'' + id + '\')">取消订单</a>';			    	
		// 	    } else{
		// 	    	opdata += '<a class="btn btn-primary btn-sm disabled" href="" disabled="disabled">付款</a> <a class="btn btn-default btn-sm disabled" href="javascript:;" disabled="disabled">取消订单</a>';			    	
		// 	    }
		
		// 	return opdata;
		// }

		function vid(value, row, index) {
			//var row=index;
			return index;
		}
	};

	function initTable() {
		$table.bootstrapTable({
			classes: 'table table-no-bordered',
			paginationPreText: '<',
			paginationNextText: '>',
			pagination: true,
			showPaginationSwitch: false,
			showFooter:false,			
			search: false,
			searchOnEnterKey: false,
			pageList: [1],
			showColumns: false,
			showRefresh: false,
			showToggle: false,
			showPaginationSwitch: false,
			idField: 'id',
			showexport: false,
			uniqueId: 'id',			
			showExport: false,
			sidePagination: 'server',
			url: '{:URL(\'home/Order/orderlist\')}',
			columns: [{
				field: 'id',
				title: '订单号',
				align: 'center'
			},{
				field: 'name',
				title: '名称',
				editable: true,
				align: 'center'
			},{
				field: 'body',
				title: '订单信息',
				editable: true,
				align: 'center'
			},{
				field: 'time',
				title: '订单时间',
				editable: true,
				align: 'center'
			},{
				field: 'money',
				title: '金额',
				editable: true,
				align: 'center'
			},{
				field: 'trade_status',
				title: '交易状态',
				editable: true,
				align: 'center'
			}],
		});
	}

	function del(id) {
		var $table = $('#otable');
		$.get("{:URL('home/Order/del')}", {				
			id: id,
		}, function(response) {
				
			
			if (response) {	
				retable();
				layer.alert(response);
			} else {
                layer.alert('操作失败！请重试！');					
			}
		});
	
	}

    function retable(){
    	$table.bootstrapTable('refresh', {silent: true});
    }
</script>