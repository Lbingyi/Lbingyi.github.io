{include file="public/header" /}
<div class="sign-container" style="background-color: #f3f7f8;">

   
    {if condition="$Think.config.global_config.site_status eq 0"}
    <h1 style="color: red;">网站关闭维护中......</h1>
    {/if}
	<form class="sign-form" id="login" name="loginform"> 		
	    <h1 style="text-align: right;padding-right: 90px">用户登录</h1>
	    
	    <div class="item">
	        <label for="inputEmail">用户名</label>
	        <input class="ipt" type="text" name="username" required class="ipt" id="inputusername" placeholder="登录用户名">
	    </div>
	    <div class="item">
	        <label for="inputPassword">密码</label>
	        <input type="password" name="password" class="ipt" id="inputPassword" placeholder="登录密码" required>
	    </div>
	    <div class="item">
	        <label for="inputval">验证码</label>
			<input type="text" name="captcha" class="ipt" id="inputcaptcha" placeholder="验证码" required style="width: 200px">               
			<div class="captcha" style="display: inline-block;"><img class="captcha-img" src="{:captcha_src()}" alt="captcha" style="width: 130px;height: 54px;border: 1px solid #ccc"/></div>
	    </div>
	    <!-- <div class="item">
				<label for=""></label>
	        <div class="captcha"><img class="captcha-img" src="{:captcha_src()}" alt="captcha" style="width: 250px;margin-left:40px"/></div>              
	    </div> -->
	    <div style="margin-top: 10px;margin-bottom: 10px" class="sign-info">
		    <input type="hidden" name="user" value="login">
		    <a href="{:URL('home/Respassword/index')}" style="font-size: 16px">找回密码？</a>
	    </div>
	    <div class="sign-sign" style="overflow: hidden;">
			<label for=""></label>
			<input id="subadd" type="submit" class="btn btn-primary btn-block" value="登 录">       
			
		</div>
		<div>
			<label for=""></label>
			<div class="sign-tips" style="display: none;"></div>
		</div>
	    
	</form>

</div>
<style type="text/css">
	.register-verification{
		text-align: center;
	}

	.sign-sign .btn {
		color: #fff !important;
		width: 321px;
		margin: 0 auto;
		height: 42px;
		line-height: 44px;
		text-align: center;
		padding: 0;
		font-size: 18px;
		display: block;
		background: #64bfff;
		border: none;
		cursor: pointer;
	}
</style>
<div class="register-verification" id="info" style="display:none">
	<div class="auth-form auth-form-text">
		<h1 id="ht" class="title">登录成功</h1>
		<p id="hp" class="text-center">！</p>
	</div>
</div>

{include file="public/flooter" /}

<script type="text/javascript">
	
	$(document).ready(function() {
		$('.captcha').click(function(){
			$('.captcha-img').attr('src','{:captcha_src()}')
		});
		$('#subadd').click(function() {
			var str_data = $("#login").serialize();			
			$.ajax({
				type: "post",
				url: "{:URL('home/Login/login')}",
				data: str_data,
				success: function(msg) {
					
					if(msg.code==10){
						$('.sign-tips').show();
						$('.sign-tips').text('用户名或密码错误！');
					}
					if(msg.code==11){
						$('.sign-tips').show();
						$('#msgbox').text('用户已被禁用！请联系管理员！');
					}
					if(msg.code==12){
						$('.sign-tips').show();
						$('.sign-tips').text('验证码错误！');
					}
					if(msg.msg=='success'){
						$('#ht').text('登录成功');
						$('#hp').text('正在为您跳转页面！');
						$('#info').attr('style','');
						$('.sign-container').attr('style','display:none');
						if(msg.code==1){
							location.href = "{:URL('admin/Index/index')}";
						}
						if(msg.code==2){
							location.href = "{:URL('home/user/index')}";
						}
						
					}
					
				}
			});
			return false;
		});
		
	});
</script>